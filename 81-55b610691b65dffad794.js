(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{700:function(e,t,a){"use strict";a.d(t,"d",(function(){return c})),a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return i})),a.d(t,"h",(function(){return o})),a.d(t,"g",(function(){return s})),a.d(t,"f",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"c",(function(){return m}));a(24),a(13);var n=a(115),r=a.n(n),c={DISH:0,COMBO:1},l={banner:null,description:"",endDate:(new Date).getTime(),startDate:(new Date).getTime(),name:"",quantity:0},i={dish:{},discountValue:0,combo:null,id:"new__",quantity:0,repeat:"",schedule:1,type:c.DISH};function o(){return Object.assign({},l,{endDate:(new Date).getTime(),startDate:(new Date).getTime(),id:"new_"+(new Date).getTime()})}function s(e,t){void 0===t&&(t=!1);var a=Object.assign({},e);return t&&a.id&&delete a.id,delete a.createdDate,delete a.restaurant,delete a.items,a}function u(e){var t=e.selectedItem&&(e.selectedItem.id||e.selectedItem.value)||null,a=Object.assign({},e,{itemId:t,schedule:e.schedule?1:0,type:e.type?1:0,dish:e.type?null:e.selectedItem,combo:e.type?e.selectedItem:null});return a.schedule&&delete a.quantity,"new__"===a.id&&delete a.id,delete a.selectedItem,delete a.combo,delete a.dish,a}var d=r()((function(e){var t=Object.assign({},e),a=e.dish||e.combo,n=a?{value:a.id,label:a.name}:m;return t=Object.assign({},t,{selectedItem:n})})),m=[{value:"---",label:"---"}]},795:function(e,t,a){"use strict";a(24),a(13);var n=a(1),r=a.n(n),c=a(115),l=a.n(c),i=a(54),o=a(578),s=a.n(o),u=a(25),d=a(42),m=a(579),p=a(700),g=a(9),D=a(78),f=(a(593),a(239));var b=function(e){var t,a;function n(t){var a;(a=e.call(this,t)||this).unmount=!1,a._setState=function(e,t){a.unmount||a.setState((function(t){return Object.assign({},t,{},e)}),t)},a.reset=function(){var e=a.state.campaignDetailRaw;a._setState({campaignDetail:e})},a.onCancel=function(){a.props.mode===g.k.NEW?a.props.onCancel():a.toggleEdit(g.k.VIEW)()},a.onSave=function(){var e=a.state.campaignDetail,t=a.props,n=t.requestData,r=t.receiveData,c=t.restaurantId,l=t.onSuccess,i=Object(p.g)(e);n(),Object(m.f)(c,i).promise.then((function(e){e.data&&200===e.data.code&&(a.turnAlert(),a.toggleEdit(g.k.VIEW)(),e.data&&e.data.value&&e.data.value.id&&l(e.data.value.id)),r()})).catch((function(e){r(),a.turnAlert(!1,e.response&&e.response.data&&e.response.data.message)}))},a.generateBtn=l()((function(e){return e!==g.k.VIEW?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{type:"button",className:"btn btn-success m-3",onClick:a.onSave},r.a.createElement(d.a,{Tag:"<>",id:"IDS_SAVE_BTN"})),r.a.createElement("button",{type:"button",className:"btn btn-secondary m-3",onClick:a.onCancel},r.a.createElement(d.a,{Tag:"<>",id:"IDS_CANCEL_BTN"}))):r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:a.toggleEdit(g.k.EDIT)},r.a.createElement(d.a,{Tag:"<>",id:"IDS_EDIT_BTN"})))}),{isReact:!0}),a.toggleEdit=l()((function(e){return function(){var t=a.state,n=t.campaignDetail,r=t.campaignDetailRaw;a._setState({mode:e,campaignDetail:e===g.k.VIEW?r:n})}})),a.onChange=function(e){var t;if(e&&e.target&&e.target.name){var n=e.target&&e.target.value||"",r=Object.assign({},a.state.campaignDetail,((t={})[e.target.name]=n,t));a._setState({campaignDetail:r})}},a.onChangeDate=l()((function(e){return function(t){var n,r=Object.assign({},a.state.campaignDetail,((n={})[e]=new Date(t).getTime(),n));a._setState({campaignDetail:r})}})),a.onChangeBanner=function(e){var t=a.props,n=t.requestData,r=t.receiveData;if(e.target.files){var c=(e.target||e.dataTransfer).files;if(c.length){var l=new window.FormData;l.append("file",c[0],c[0].filename||"img.jpg"),n(),Object(f.b)(l).promise.then((function(e){if(e.data&&e.data.value&&e.data.value){var t=a.state.campaignDetail,n=s()(t,{banner:{$set:e.data.value.url}});a._setState({campaignDetail:n})}r()})).catch((function(){r()}))}}},a.turnAlert=function(e,t){void 0===e&&(e=!0);var n=a.props.toggleAlert;n(e?{color:g.b.SUCCESS,text:"IDS_ALERT_UPDATE_SUCCESS",message:t}:{color:g.b.DANGER,text:"IDS_ALERT_UPDATE_FAIL",message:t})},a.defaultCampaign=Object(p.h)();var n=!(t.data&&t.data.id),c=t.data&&t.data.id?t.data:a.defaultCampaign,i=t.mode||g.k.VIEW;return a.state={campaignDetail:c,campaignDetailRaw:c,mode:i,isNew:n},a}a=e,(t=n).prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a,n.getDerivedStateFromProps=function(e,t){return e.data!==t.campaignDetailRaw?{campaignDetail:e.data,campaignDetailRaw:e.data}:null};var c=n.prototype;return c.componentWillUnmount=function(){this.unmount=!0},c.render=function(){var e=this.state,t=e.campaignDetail,a=e.mode,n=e.isNew,c=t.id,l=t.endDate,i=t.startDate,o=t.name,s=t.description,u=t.banner,d=t.createdDate;return r.a.createElement("form",{className:"campaign-common-wrapper container"},r.a.createElement("div",{className:"row mt-2"},!n&&r.a.createElement(D.a,{id:"id",label:"IDS_DISH_LABEL_ID",value:c,name:"id",isReadOnly:!0,mode:g.k.VIEW,classLabel:"col-xs-12 col-lg-4",classInputContainer:"col-xs-12 col-lg-8",classWrapper:"col-lg-6"}),r.a.createElement(D.a,{id:"name",label:"IDS_LABEL_CAMPAIGN_NAME",value:o,name:"name",onChange:this.onChange,mode:a,classLabel:"col-xs-12 "+(n?"col-lg-2":"col-lg-4"),classInputContainer:"col-xs-12 "+(n?"col-lg-10":"col-lg-8"),classWrapper:n?"col-lg-12":"col-lg-6"})),r.a.createElement("div",{className:"row mt-2"},r.a.createElement(D.a,{id:"description",label:"IDS_LABEL_CAMPAIGN_DESCRIPTION",value:s,name:"description",onChange:this.onChange,mode:a,type:"textarea",classLabel:"col-xs-12 col-lg-2",classInputContainer:"col-xs-12 col-lg-10",classWrapper:"col-lg-12"})),r.a.createElement("div",{className:"row mt-2"},r.a.createElement(D.a,{id:"banner",label:"IDS_LABEL_CAMPAIGN_BANNER",value:u,name:"banner",onChange:this.onChangeBanner,mode:a,type:"single-image",classLabel:"col-xs-12 col-lg-2",classInputContainer:"col-xs-12 col-lg-10",classWrapper:"col-lg-12"}),d&&r.a.createElement(D.a,{id:"createdDate",label:"IDS_LABEL_CAMPAIGN_CREATED_DATE",value:d,name:"createdDate",isReadOnly:!0,type:"datepicker",mode:g.k.VIEW,classLabel:"col-xs-12 col-lg-4",classInputContainer:"col-xs-12 col-lg-8",classWrapper:"col-lg-6"})),r.a.createElement("div",{className:"row mt-2"},r.a.createElement(D.a,{id:"startDate",label:"IDS_LABEL_CAMPAIGN_FROM_DATE",value:i,name:"startDate",onChange:this.onChangeDate("startDate"),mode:a,type:"datepicker",classLabel:"col-xs-12 col-lg-4",classInputContainer:"col-xs-12 col-lg-8",classWrapper:"col-lg-6"}),r.a.createElement(D.a,{id:"endDate",label:"IDS_LABEL_CAMPAIGN_END_DATE",value:l,name:"endDate",onChange:this.onChangeDate("endDate"),mode:a,type:"datepicker",classLabel:"col-xs-12 col-lg-4",classInputContainer:"col-xs-12 col-lg-8",classWrapper:"col-lg-6"})),r.a.createElement("div",{className:"row mt-2 d-flex justify-content-center"},this.generateBtn(a)))},n}(r.a.PureComponent);b.defaultProps={data:null,onSuccess:function(e){return e},onCancel:function(e){return e}},t.a=Object(i.b)((function(e){return{restaurantId:e.restaurant.restaurantId,user:e.user.info}}),(function(e){return{requestData:function(){return e(Object(u.b)())},receiveData:function(){return e(Object(u.a)())},toggleAlert:function(t){return e(Object(u.c)(t))}}}))(b)},838:function(e,t,a){"use strict";a.r(t);a(24);var n=a(1),r=a.n(n),c=a(54),l=a(91),i=a(25),o=a(42),s=a(23),u=a(795),d=a(700),m=a(9);var p=function(e){var t,a;function n(t){var a;return(a=e.call(this,t)||this).onSaveSucceess=function(e){Object(l.navigate)(s.a.CAMPAIGN_DETAIL+"?id="+e)},a.onCancel=function(){Object(l.navigate)(s.a.CAMPAIGN)},a.state={campaignDetail:d.b},a}return a=e,(t=n).prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a,n.prototype.render=function(){var e=this.state.campaignDetail;return r.a.createElement("div",{className:"page-wrapper campaign-detail-wrapper container-fluid"},r.a.createElement("div",{className:"d-sm-flex align-items-center header-wrapper"},r.a.createElement(o.a,{id:"IDS_LABEL_CAMPAIGN_CREATE_NEW",values:{name:e.name||""},Tag:"h3",className:"mb-0 text-dark"})),r.a.createElement("div",{className:"campaign-detail-body-wrapper"},r.a.createElement(u.a,{mode:m.k.NEW,onCancel:this.onCancel,onSuccess:this.onSaveSucceess,data:e})))},n}(r.a.PureComponent);t.default=Object(c.b)((function(e){return{restaurantId:e.restaurant.restaurantId,user:e.user.info}}),(function(e){return{requestData:function(){return e(Object(i.b)())},receiveData:function(){return e(Object(i.a)())},toggleAlert:function(t){return e(Object(i.c)(t))}}}))(p)}}]);