(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{793:function(e,t,a){"use strict";var n=a(1),r=a.n(n),o=a(649),l=a(639),s=a(641),i=a(325),c=a(42),u=r.a.memo((function(e){var t=e.isOpen,a=e.toggle,n=e.onOk,u=e.centered;return r.a.createElement(o.a,{size:"sm",isOpen:t,toggle:a,centered:u},r.a.createElement(l.a,null,r.a.createElement(c.a,{id:"IDS_CONFIRM_DELETE"})),r.a.createElement(s.a,null,r.a.createElement(i.a,{className:"btn-danger",onClick:n},r.a.createElement(c.a,{Tag:"<>",id:"IDS_CONFIRM_OK"})),r.a.createElement(i.a,{onClick:a},r.a.createElement(c.a,{Tag:"<>",id:"IDS_CONFIRM_NO"}))))}));u.defaultProps={isOpen:!1,toggle:function(e){return e},onOk:function(e){return e},centered:!0},t.a=u},851:function(e,t,a){"use strict";a.r(t);a(18),a(19),a(11),a(13);var n=a(1),r=a.n(n),o=a(54),l=a(77),s=a(147),i=a(970),c=a(91),u=a(40),m=a(23),d=a(25),p=a(9),E=a(576),g=a(587),f=a(67),D=a(573),S=a(629),_=a(630),h=a(184),b=a(631),I=a(647),O=a(643),L=a(644),v=a(642),T=a(325),A=a(42),C=a(237);var x=function(e){var t,a;function n(t){var a;return(a=e.call(this,t)||this).toggleStatus=function(){a.setState((function(e){return{isOpenStatus:!e.isOpenStatus}}))},a.onChangeStatus=function(e){return function(){a.setState({status:e})}},a.onChangeText=function(e){a.setState({text:e.target.value})},a.onSubmit=function(e){e.preventDefault();var t=a.state,n=t.status,r={orderStatus:"ALL"===n?"":n,searchText:t.text,toDate:t.toDate,fromDate:t.fromDate};a.props.onSearch(r)},a.onChangeDate=function(e){return function(t){var n;a.setState(((n={})[e]=Object(s.default)(t,p.d),n))}},a.state={text:"",status:E.d.keys[1],isOpenStatus:!1,fromDate:Object(s.default)(new Date,p.d),toDate:Object(s.default)(new Date,p.d)},a}a=e,(t=n).prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a;var o=n.prototype;return o.componentDidMount=function(){this.setState({status:this.props.status})},o.render=function(){var e=this,t=this.state,a=t.text,n=t.isOpenStatus,o=t.status,l=t.fromDate,s=t.toDate,i=this.props,c=i.intl,m=i.getListBill;return r.a.createElement(S.a,{className:"toolbar-orders-wrapper d-flex align-items-center justify-content-end",method:"post",onSubmit:this.onSubmit},r.a.createElement(_.a,{className:"mr-2 flex-grow-1"},r.a.createElement(h.a,{value:a,onChange:this.onChangeText,onKeyDown:this.onKeyDown,className:"input-group",placeholder:c.formatMessage({id:"IDS_SEARCH_BY_USERNAME"})})),r.a.createElement(_.a,{className:"date-picker-order ml-2 mr-2 d-flex align-items-center"},r.a.createElement(b.a,{className:"mb-0 mr-2"},r.a.createElement(A.a,{Tag:"<>",id:"IDS_LABLE_FROM"})),r.a.createElement(C.a,{mode:p.k.EDIT,date:new Date(l),onChange:this.onChangeDate("fromDate")})),r.a.createElement(_.a,{className:"date-picker-order ml-2 mr-2 d-flex align-items-center"},r.a.createElement(b.a,{className:"mb-0 mr-2"},r.a.createElement(A.a,{Tag:"<>",id:"IDS_LABEL_TO"})),r.a.createElement(C.a,{mode:p.k.EDIT,date:new Date(s),onChange:this.onChangeDate("toDate")})),r.a.createElement(_.a,{className:"ml-2 mr-2"},r.a.createElement(b.a,{className:"mr-2"},r.a.createElement(A.a,{Tag:"<>",id:"IDS_DISH_LABEL_STATUS"})),r.a.createElement(I.a,{isOpen:n,toggle:this.toggleStatus},r.a.createElement(O.a,{caret:!0},r.a.createElement(A.a,{Tag:"<>",id:E.d.items[o]})),r.a.createElement(L.a,{right:!0},E.d.keys.map((function(t){return r.a.createElement(v.a,{key:t,onClick:e.onChangeStatus(t)},r.a.createElement(A.a,{Tag:"<>",id:E.d.items[t]}))}))))),r.a.createElement(_.a,null,r.a.createElement(T.a,{color:"primary",type:"submit",onClick:this.onSubmit},r.a.createElement(u.s,null))),r.a.createElement(_.a,{className:"ml-2"},r.a.createElement(T.a,{color:"success",type:"button",onClick:m},r.a.createElement(u.v,null))))},n}(n.PureComponent);x.defaultProps={searchText:"",onBlurSearchText:function(e){return e},getListBill:function(e){return e},onSearch:function(e){return e},status:E.d.keys[3]};var y=Object(l.injectIntl)(x),B=a(793),M=(a(614),a(575));var k=function(e){var t,a;function n(t){var a;return(a=e.call(this,t)||this).unmount=!1,a._setState=function(e,t){a.unmount||a.setState((function(t){return Object.assign({},t,{},e)}),t)},a.getAllBill=function(){if(!a.unmount){var e=a.props,t=e.requestData,n=e.receiveData,r=e.restaurantId,o=a.state,l=o.searchText,s=o.orderStatus,i=o.fromDate,c=o.toDate,u=a.props,m=u.pageSize,d=u.pageIndex,p={orderBy:u.orderBy,sortBy:u.sortBy,orderStatus:s,pageNum:d,pageSize:m,restaurantId:r,userName:l,fromDate:i,toDate:c};t(),Object(g.d)(p).promise.then((function(e){if(e.data&&e.data.code&&200===e.data.code&&e.data.value){var t=e.data.value&&e.data.value.list||[],r=e.data.value&&e.data.value.totalPages||0;a._setState({listBill:t,totalSize:r*m})}n()})).catch((function(){n()}))}},a.formatTime=function(e){return e?Object(s.default)(new Date(1e3*e),p.g):""},a.getLabelOrderStatus=function(e){var t=a.props.intl.formatMessage,n=e;return null!=e&&null!==E.b.items[e]&&void 0!==E.b.items[e]&&(n=t({id:E.b.items[e]})),r.a.createElement("div",{className:"status-item py-1 px-3 "+E.a[e]},n)},a.generateColumns=function(){var e=a.props.intl.formatMessage;return[{dataField:"orderId",text:"ID",sort:!0,headerStyle:function(){return{width:"80px"}}},{dataField:"tableLocation",text:e({id:"IDS_DISH_LABEL_TABLE_LOCATION"}),headerStyle:function(){return{width:"100px"}},sort:!0},{dataField:"createdDate",text:e({id:"IDS_DISH_LABEL_CREATE_TIME"}),sort:!0,formatter:function(e,t){return a.formatTime(t.createdDate)}},{dataField:"lastModifiedDate",text:e({id:"IDS_DISH_LABEL_LAST_MODIFIER_TIME"}),sort:!0,formatter:function(e,t){return a.formatTime(t.lastModifiedDate)}},{dataField:"totalPrice",text:e({id:"IDS_DISH_LABEL_TOTAL_PRICE"}),sort:!0,formatter:function(e,t){return Object(f.n)(t.totalPrice||"0")}},{dataField:"orderStatus",text:e({id:"IDS_DISH_LABEL_STATUS"}),sort:!0,formatter:function(e,t){return a.getLabelOrderStatus(t.orderStatus)}},{dataField:"tool",text:e({id:"IDS_DISH_LABEL_TOOLS"}),formatter:a.generateTools}]},a.generateTools=function(e,t,n){return r.a.createElement("div",{className:"tool"},r.a.createElement("button",{type:"button",className:"btn btn-primary my-2 mx-2 rounded btn-sm btn-md",onClick:a.handleClickView(t,n)},r.a.createElement(u.k,null)),r.a.createElement("button",{type:"button",className:"btn btn-danger my-2 mx-2 rounded btn-sm btn-md",onClick:a.handleClickDelete(t,n)},r.a.createElement(u.x,null)))},a.handleClickView=function(e){return function(t){t&&(t.preventDefault(),t.stopPropagation()),Object(c.navigate)(m.a.ORDER_DETAIL+"?id="+e.orderId,{state:{mode:p.k.VIEW}})}},a.handleClickDelete=function(e){return function(t){t&&(t.preventDefault(),t.stopPropagation()),a._setState({deleteItems:[e]},(function(){a.toggleDeleteModal()}))}},a.toggleDeleteModal=function(){var e=a.state,t=e.isOpenDeleteModal,n=e.deleteItems,r={isOpenDeleteModal:!t,deleteItems:t?[]:n};a._setState(r)},a.onOkDeleteModal=function(){var e=a.state.deleteItems,t=a.props,n=t.requestData,r=t.receiveData;e.length&&e[0]&&e[0].orderStatus!==E.c.keys[3]&&e.length&&e[0]&&e[0].orderId&&(n(),Object(g.b)(e[0].orderId).promise.then((function(){a.getListBill(),a.toggleDeleteModal(),a.turnAlert()})).catch((function(e){r(),a.toggleDeleteModal(),a.turnAlert(!1,e&&e.response&&e.response.data&&e.response.data.message||"")})))},a.turnAlert=function(e,t){void 0===e&&(e=!0);var n=a.props.toggleAlert;n(e?{color:p.b.SUCCESS,text:"IDS_ALERT_UPDATE_SUCCESS",message:t}:{color:p.b.DANGER,text:"IDS_ALERT_UPDATE_FAIL",message:t})},a.onSearch=function(e){var t=Object.assign({},a.state,{},e);a._setState(t,(function(){a.getAllBill()}))},a.state={searchText:"",totalSize:0,isOpenDeleteModal:!1,deleteItems:[],orderStatus:E.d.keys[1],listBill:[],fromDate:Object(s.default)(new Date,p.d),toDate:Object(s.default)(new Date,p.d)},a}a=e,(t=n).prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a;var o=n.prototype;return o.componentDidMount=function(){var e=this;this.getAllBill(),this.interval=setInterval((function(){e.getAllBill()}),6e4)},o.componentWillUnmount=function(){this.unmount=!0,clearInterval(this.interval)},o.render=function(){var e=this.state,t=e.listBill,a=e.orderStatus,n=e.totalSize,o=e.isOpenDeleteModal,s=e.deleteItems,c=this.props,m=c.pageSize,d=c.onSort,p=c.onPageChange,E=c.onSizePerPageChange;return r.a.createElement("div",{className:"page-wrapper bill-wrapper container-fluid"},r.a.createElement("div",{className:"d-sm-flex align-items-center header-wrapper"},r.a.createElement(A.a,{id:"IDS_MENU_ORDER",Tag:"h3",className:"mb-0 text-dark"}),r.a.createElement("span",{className:"ml-1",href:"#",id:"TooltipExample"},r.a.createElement(u.r,null)),r.a.createElement(i.a,{placement:"bottom",innerClassName:"help-tooltip",target:"TooltipExample"},r.a.createElement(A.a,{Tag:"h5",id:"IDS_LABEL_ORDER_HELP_1"}),r.a.createElement("br",null),r.a.createElement(l.FormattedHTMLMessage,{id:"IDS_LABEL_ORDER_HELP_ALL_STATUS"}),r.a.createElement("br",null),r.a.createElement(l.FormattedHTMLMessage,{id:"IDS_LABEL_ORDER_HELP_ORDER_1"}),r.a.createElement("br",null),r.a.createElement(l.FormattedHTMLMessage,{id:"IDS_LABEL_ORDER_HELP_ORDER_2"}),r.a.createElement("br",null))),r.a.createElement("div",{className:"order-body-wrapper"},r.a.createElement(y,{onSearch:this.onSearch,status:a,getListBill:this.getAllBill}),r.a.createElement("div",{className:"table-wrapper"},r.a.createElement(D.a,{totalSize:n,keyField:"id",data:t,columns:this.generateColumns(),onPageChange:p,onSizePerPageChange:E,pageSize:m,onSort:d})),r.a.createElement(B.a,{isOpen:o,toggle:this.toggleDeleteModal,onOk:this.onOkDeleteModal,deleteItems:s})))},n}(n.PureComponent),N={pageSize:p.h,pageIndex:1,orderBy:"desc",sortBy:"createdDate",functionGetData:"getAllBill"};t.default=Object(l.injectIntl)(Object(o.b)((function(e){return{restaurantId:e.restaurant.restaurantId}}),(function(e){return{requestData:function(){return e(Object(d.b)())},receiveData:function(){return e(Object(d.a)())},toggleAlert:function(t){return e(Object(d.c)(t))}}}))(Object(M.a)(k,N)))}}]);