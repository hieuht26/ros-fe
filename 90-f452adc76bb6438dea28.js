(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{837:function(e,t,a){"use strict";a.r(t);a(13);var n=a(1),r=a.n(n),o=a(54),i=a(91),l=a(147),c=a(40),s=a(77),d=a(649),u=a(639),m=a(641),p=a(325),g=a(25),f=a(42),D=a(573),E=a(9),b=a(575),C=a(579),_=a(23);a(621);var A=function(e){var t,a;function n(t){var a;return(a=e.call(this,t)||this).unmount=!1,a._setState=function(e,t){a.unmount||a.setState((function(t){return Object.assign({},t,{},e)}),t)},a.getListCampaign=function(){var e=a.state.searchText,t=a.props,n=t.restaurantId,r=t.requestData,o=t.receiveData,i=a.props,l=i.pageSize,c=i.pageIndex,s=i.orderBy,d=i.sortBy,u={orderBy:s,pageNum:c,pageSize:l,sortBy:d,searchText:e,restaurantId:n,name:""};r(),Object(C.e)(n,u).promise.then((function(e){if(e.data&&e.data.code&&200===e.data.code&&e.data.value){var t=e.data.value&&e.data.value.list||[],n=e.data.value&&e.data.value.totalPages||0;a._setState({listCampaign:t,totalSize:n*l})}o()})).catch((function(){o()}))},a.formatTime=function(e){return e?Object(l.default)(new Date(e),E.c):""},a.generateColumns=function(){var e=a.props.intl.formatMessage;return[{dataField:"id",text:"ID",sort:!0,headerStyle:{width:"80px"}},{dataField:"name",text:e({id:"IDS_LABEL_CAMPAIGN_NAME"}),sort:!0},{dataField:"banner",text:e({id:"IDS_LABEL_CAMPAIGN_BANNER"}),formatter:a.generateBannerColumns},{dataField:"description",text:e({id:"IDS_LABEL_CAMPAIGN_DESCRIPTION"}),sort:!0},{dataField:"startDate",text:e({id:"IDS_LABEL_CAMPAIGN_FROM_DATE"}),sort:!0,formatter:function(e,t){return a.formatTime(t.startDate)}},{dataField:"endDate",text:e({id:"IDS_LABEL_CAMPAIGN_END_DATE"}),sort:!0,formatter:function(e,t){return a.formatTime(t.endDate)}},{dataField:"tool",text:e({id:"IDS_DISH_LABEL_TOOLS"}),formatter:a.generateTools,headerStyle:{width:"120px"},style:{textAlign:"center",padding:"0.5rem"}}]},a.generateBannerColumns=function(e){return e?r.a.createElement("img",{className:"banner-img",src:e,alt:"banner"}):""},a.generateTools=function(e,t,n){return r.a.createElement("div",{className:"tool"},r.a.createElement("button",{type:"button",className:"btn btn-primary my-2 mx-2 rounded btn-sm btn-md",onClick:a.handleClickView(t,n)},r.a.createElement(c.k,null)),r.a.createElement("button",{type:"button",className:"btn btn-danger my-2 mx-2 rounded btn-sm btn-md",onClick:a.toggleDeleteModal(t,n)},r.a.createElement(c.x,null)))},a.handleClickView=function(e){return function(t){t&&(t.preventDefault(),t.stopPropagation()),Object(i.navigate)(_.a.CAMPAIGN_DETAIL+"?id="+e.id,{state:{item:e}})}},a.onClickAdd=function(){Object(i.navigate)(_.a.CAMPAIGN_NEW)},a.toggleDeleteModal=function(e){return function(){var t={isOpenDeleteModal:!a.state.isOpenDeleteModal,deleteItem:e};a._setState(t)}},a.handleClickDelete=function(){var e=a.state.deleteItem;if(e&&e.id){var t=a.props,n=t.requestData,r=t.receiveData;n(),Object(C.a)(e.id).promise.then((function(){a.toggleDeleteModal(null)(),a.getListCampaign(),a.turnAlert(),r()})).catch((function(){r(),a.turnAlert(0)}))}},a.turnAlert=function(e,t){void 0===e&&(e=!0);var n=a.props.toggleAlert;n(e?{color:E.b.SUCCESS,text:"IDS_ALERT_UPDATE_SUCCESS",message:t}:{color:E.b.DANGER,text:"IDS_ALERT_UPDATE_FAIL",message:t})},a.state={totalSize:0,listCampaign:[],searchText:"",isOpenDeleteModal:!1,deleteItem:{}},a}a=e,(t=n).prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a;var o=n.prototype;return o.componentDidMount=function(){this.getListCampaign()},o.componentWillUnmount=function(){this.unmount=!0,clearInterval(this.interval)},o.render=function(){var e=this.state,t=e.listCampaign,a=e.totalSize,n=e.isOpenDeleteModal,o=this.props,i=o.pageSize,l=o.onSort,s=o.onPageChange,g=o.onSizePerPageChange;return r.a.createElement("div",{className:"page-wrapper campaign-wrapper container-fluid"},r.a.createElement("div",{className:"d-sm-flex align-items-center header-wrapper"},r.a.createElement(f.a,{id:"IDS_MENU_CAMPAIGN",Tag:"h3",className:"mb-0 text-dark"})),r.a.createElement("div",{className:"campaign-body-wrapper"},r.a.createElement("div",{className:"toolbar-table-wrapper d-flex justify-content-end form-group"},r.a.createElement("button",{className:"btn btn-success rounded",type:"button",onClick:this.onClickAdd},r.a.createElement(c.q,{size:"1.5em"}))),r.a.createElement("div",{className:"table-wrapper"},r.a.createElement(D.a,{totalSize:a,keyField:"id",data:t,columns:this.generateColumns(),onPageChange:s,onSizePerPageChange:g,pageSize:i,onSort:l}))),r.a.createElement(d.a,{isOpen:n,size:"sm",centered:!0,toggle:this.toggleDeleteModal(null)},r.a.createElement(u.a,null,r.a.createElement(f.a,{id:"IDS_CONFIRM_DELETE"})),r.a.createElement(m.a,null,r.a.createElement(p.a,{className:"btn-danger",onClick:this.handleClickDelete},r.a.createElement(f.a,{Tag:"<>",id:"IDS_CONFIRM_OK"})),r.a.createElement(p.a,{onClick:this.toggleDeleteModal(null)},r.a.createElement(f.a,{Tag:"<>",id:"IDS_CONFIRM_NO"})))))},n}(n.PureComponent),I={pageSize:E.h,pageIndex:1,orderBy:"desc",sortBy:"createdDate",functionGetData:"getListCampaign"};t.default=Object(s.injectIntl)(Object(o.b)((function(e){return{restaurantId:e.restaurant.restaurantId}}),(function(e){return{requestData:function(){return e(Object(g.b)())},receiveData:function(){return e(Object(g.a)())},toggleAlert:function(t){return e(Object(g.c)(t))}}}))(Object(b.a)(A,I)))}}]);