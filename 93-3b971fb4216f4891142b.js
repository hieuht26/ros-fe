(window.webpackJsonp=window.webpackJsonp||[]).push([[93],{730:function(e,a,t){"use strict";t.r(a);t(13),t(24);var n=t(1),r=t.n(n),l=t(54),s=t(629),o=t(184),c=t(325),i=t(115),u=t.n(i),m=t(40),d=t(77),g=t(42),p=t(25),E=t(586),f=(t(594),t(9)),v=t(239),b=t(649),h=t(639),S=t(640),N=t(641),C=t(238),_=function(e){return null==e||""===e};var A=function(e){var a=e.isOpen,t=e.toggle,l=e.turnAlert,s=Object(n.useState)(""),o=s[0],i=s[1],u=Object(n.useState)(""),m=u[0],d=u[1],p=Object(n.useState)(""),E=p[0],f=p[1],v=Object(n.useState)(!1),A=v[0],D=v[1];Object(n.useEffect)((function(){_(o)||_(m)||_(E)||m!==E?D(!1):D(!0)}));var I=function(){a&&(i(""),d(""),f("")),t()};return r.a.createElement(b.a,{unmountOnClose:!0,isOpen:a,toggle:I},r.a.createElement(h.a,null,r.a.createElement(g.a,{Tag:"<>",id:"IDS_LABEL_CHANGE_PASSWORD"})),r.a.createElement(S.a,null,r.a.createElement("form",null,r.a.createElement("div",{className:"form-group"},r.a.createElement(g.a,{Tag:"label",className:"font-weight-bolder",id:"IDS_LABEL_CURRENT_PASSWORD"}),r.a.createElement("input",{className:"form-control",type:"password",name:"oldPass",value:o,onChange:function(e){return i(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement(g.a,{Tag:"label",className:"font-weight-bolder",id:"IDS_LABEL_NEW_PASSWORD"}),r.a.createElement("input",{className:"form-control",type:"password",name:"oldPass",value:m,onChange:function(e){return d(e.target.value)}})),r.a.createElement("div",{className:"form-group"},r.a.createElement(g.a,{Tag:"label",className:"font-weight-bolder",id:"IDS_LABEL_RE_NEW_PASSWORD"}),r.a.createElement("input",{className:"form-control",type:"password",name:"oldPass",value:E,onChange:function(e){return f(e.target.value)}})))),r.a.createElement(N.a,null,r.a.createElement(c.a,{type:"button",className:"m-2",color:"primary",disabled:!A,onClick:function(){A&&Object(C.b)({newPassword:m,oldPassword:o}).promise.then((function(e){e&&e.data&&e.data.code&&200===e.data.code?(l(!0,e&&e.data&&e.data.value),t()):l(!1,e&&e.data&&e.data.value)})).catch((function(e){l(!1,e.response&&e.response.data&&e.response.data.value)}))}},r.a.createElement(g.a,{Tag:"<>",id:"IDS_BTN_CHANGE_PASSWORD"})),r.a.createElement(c.a,{type:"button",className:"m-2",color:"secondary",onClick:I},r.a.createElement(g.a,{Tag:"<>",id:"IDS_CANCEL_BTN"}))))},D=t(78);var I=function(e){var a,t;function n(){for(var a,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(a=e.call.apply(e,[this].concat(n))||this).state={rawUser:{},user:{},isEdit:!1,openChangePassModal:!1},a.toggleChangePass=function(){var e=!a.state.openChangePassModal;a.setState({openChangePassModal:e})},a.toggleEdit=function(){a.setState((function(e){return{isEdit:!e.isEdit}}))},a.onChange=function(e){var t;if(e&&e.target&&e.target.name){var n=a.state.user,r=Object.assign({},n,((t={})[e.target.name]=e.target.value,t));a.setState({user:r})}},a.onCancelSave=function(){var e=a.state.rawUser;a.setState({user:e},(function(){a.toggleEdit()}))},a.onSaveUser=function(){var e=a.state.user,t=a.props,n=t.requestData,r=t.receiveData,l=t.getUser,s=e.gender,o=e.avatar,c=e.name,i=e.phoneNumber,u=e.id,m={fileid:o&&o.id||"",gender:null==s?"":s,name:c,phoneNumber:i||""};n(),Object(C.d)(u,m).promise.then((function(e){r(),e&&e.data&&200===e.data.code?(a.turnAlert(),l(!0),a.toggleEdit()):a.turnAlert(0)})).catch((function(){r(),a.turnAlert(0)}))},a.onChangePicture=function(e){var t=a.props,n=t.requestData,r=t.receiveData;if(e.target.files){var l=(e.target||e.dataTransfer).files;if(l.length){var s=a.state.user,o=new window.FormData;o.append("file",l[0],l[0].filename||"img.jpg"),n(),Object(v.b)(o).promise.then((function(e){if(e.data&&e.data.value&&e.data.value){var t=e.data.value,n=Object.assign({},s,{avatar:t});a.setState({user:n}),r()}else r()})).catch((function(){r()}))}}},a.genListGender=u()((function(e){var t=a.props.intl;return e.map((function(e){return{title:t.formatMessage({id:e.title}),value:e.value}}))})),a.turnAlert=function(e,t){void 0===e&&(e=!0);var n=a.props.toggleAlert;n(e?{color:f.b.SUCCESS,text:"IDS_ALERT_UPDATE_SUCCESS",message:t}:{color:f.b.DANGER,text:"IDS_ALERT_UPDATE_FAIL",message:t})},a}return t=e,(a=n).prototype=Object.create(t.prototype),a.prototype.constructor=a,a.__proto__=t,n.getDerivedStateFromProps=function(e,a){return e.user!==a.rawUser?{rawUser:e.user,user:e.user}:null},n.prototype.render=function(){var e=this.state,a=e.user,t=e.isEdit,n=e.openChangePassModal;return r.a.createElement(s.a,{className:"user-wrapper pt-4"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12 col-md-4 text-center"},r.a.createElement("img",{src:a.avatar&&a.avatar.url||"/images/avatar.png",className:"img-thumbnail avatar-thumbnail",alt:"avatar"}),t&&r.a.createElement("div",{className:"upload-avatar border p-1"},r.a.createElement(o.a,{onChange:this.onChangePicture,className:"input-upload",type:"file",accept:"image/*",name:"file"}),r.a.createElement("div",{className:"avtar-upload-icon"},r.a.createElement(m.n,{size:"1.5em"})))),r.a.createElement("div",{className:"col-12 offset-0 col-md-7 offset-md-1 col-lg-8 offset-lg-0"},r.a.createElement("div",{className:"row"},r.a.createElement(D.a,{classWrapper:"col-lg-6",id:"username",name:"username",label:"IDS_LABEL_USERNAME",value:a.username,mode:f.k.VIEW,type:"text",classLabel:"col-12",classInputContainer:"col-12",isReadOnly:!0}),r.a.createElement(D.a,{classWrapper:"col-lg-6",id:"email",label:"IDS_LABEL_EMAIL",value:a.email,name:"email",mode:f.k.VIEW,type:"text",classLabel:"col-12",classInputContainer:"col-12",isReadOnly:!0}),r.a.createElement(D.a,{classWrapper:"col-lg-6",id:"name",label:"IDS_LABEL_NAME",value:a.name,name:"name",mode:t?f.k.EDIT:f.k.VIEW,onChange:this.onChange,type:"text",classLabel:"col-12",classInputContainer:"col-12"}),r.a.createElement(D.a,{classWrapper:"col-lg-6",id:"phoneNumber",label:"IDS_LABEL_PHONE",value:a.phoneNumber,name:"phoneNumber",mode:t?f.k.EDIT:f.k.VIEW,onChange:this.onChange,type:"text",classLabel:"col-12",classInputContainer:"col-12"}),r.a.createElement(D.a,{classWrapper:t?"col-lg-12":"col-lg-6",id:"gender",label:"IDS_LABEL_GENDER",value:a.gender,name:"gender",mode:t?f.k.EDIT:f.k.VIEW,onChange:this.onChange,list:this.genListGender(f.j),type:"radio-group",classLabel:"col-12",classInputContainer:"col-12"})),t?r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement(c.a,{type:"button",className:"m-2",color:"success",onClick:this.onSaveUser},r.a.createElement(g.a,{Tag:"<>",id:"IDS_SAVE_BTN"})),r.a.createElement(c.a,{type:"button",className:"m-2",color:"secondary",onClick:this.onCancelSave},r.a.createElement(g.a,{Tag:"<>",id:"IDS_CANCEL_BTN"}))):r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement(c.a,{type:"button",className:"m-2",color:"primary",onClick:this.toggleEdit},r.a.createElement(g.a,{Tag:"<>",id:"IDS_EDIT_BTN"})),r.a.createElement(c.a,{type:"button",className:"m-2",color:"secondary",onClick:this.toggleChangePass},r.a.createElement(g.a,{Tag:"<>",id:"IDS_BTN_CHANGE_PASSWORD"}))))),r.a.createElement(A,{turnAlert:this.turnAlert,isOpen:n,toggle:this.toggleChangePass}))},n}(r.a.PureComponent);a.default=Object(l.b)((function(e){return{user:e.user.info}}),(function(e){return{requestData:function(){return e(Object(p.b)())},receiveData:function(){return e(Object(p.a)())},toggleAlert:function(a){return e(Object(p.c)(a))},getUser:function(a){return e(Object(E.a)(a))}}}))(Object(d.injectIntl)(I))}}]);